<!-- TESTOVACÍ KOMENTÁŘ PRO GITHUB DESKTOP - změna pro ověření sledování souboru -->
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adam Hornof</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #00c6ff;
      --secondary: #0072ff;
      --bg: #10131a;
      --card: #181c24;
      --accent: #fff;
      --muted: #aaa;
      --radius: 1.5rem;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: var(--bg);
      color: var(--accent);
      min-height: 100vh;
      line-height: 1.7;
      letter-spacing: 0.01em;
    }
    header {
      background: linear-gradient(120deg, var(--primary), var(--secondary));
      padding: 3rem 2rem 2rem 2rem;
      text-align: center;
      border-bottom-left-radius: var(--radius);
      border-bottom-right-radius: var(--radius);
      box-shadow: 0 8px 32px rgba(0,0,0,0.18);
      position: relative;
      z-index: 2;
    }
    header h1 {
      font-size: 3.2rem;
      font-weight: 800;
      letter-spacing: 2px;
      margin-bottom: 0.5rem;
      color: #fff;
      text-shadow: 0 2px 12px #0072ff55;
    }
    header p {
      font-size: 1.3rem;
      color: #e0f7ff;
      margin-bottom: 1.5rem;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 2.5rem;
      background: var(--card);
      padding: 1.2rem 0;
      border-radius: 0 0 var(--radius) var(--radius);
      box-shadow: 0 2px 12px #0002;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    nav a {
      color: var(--primary);
      font-weight: 600;
      font-size: 1.1rem;
      text-decoration: none;
      padding: 0.3rem 1rem;
      border-radius: 0.5rem;
      transition: background 0.2s, color 0.2s;
    }
    nav a:hover {
      background: var(--primary);
      color: #10131a;
    }
    main {
      max-width: 900px;
      margin: 3rem auto 2rem auto;
      padding: 0 2rem;
      display: flex;
      flex-direction: column;
      gap: 3rem;
    }
    section {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 2px 24px #0003;
      padding: 2.5rem 2rem;
      margin-bottom: 0;
      position: relative;
      overflow: hidden;
    }
    section h2 {
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--primary);
      margin-bottom: 1.2rem;
      letter-spacing: 1px;
      border-bottom: 2px solid var(--primary);
      display: inline-block;
      padding-bottom: 0.3rem;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .profile {
      display: flex;
      align-items: center;
      gap: 2.5rem;
      margin-bottom: 2rem;
    }
    .profile img {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 4px 24px #00c6ff33;
      border: 4px solid var(--primary);
      background: #fff;
    }
    .profile-info {
      flex: 1;
    }
    .project-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2rem;
    }
    .project {
      background: #23283a;
      border-radius: 1rem;
      box-shadow: 0 2px 16px #0072ff22;
      padding: 1.5rem 1.2rem;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      transition: transform 0.2s;
    }
    .project:hover {
      transform: translateY(-4px) scale(1.03);
      box-shadow: 0 6px 32px #00c6ff44;
    }
    .project h3 {
      color: var(--primary);
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    .project ul {
      padding-left: 1.2rem;
      margin-bottom: 0.5rem;
    }
    .project li {
      margin-bottom: 0.3rem;
      color: var(--muted);
      font-size: 1rem;
    }
    .project a.button {
      margin-top: 0.5rem;
      margin-right: 0.7rem;
      background: var(--primary);
      color: #10131a;
      font-weight: 600;
      border-radius: 0.5rem;
      padding: 0.5rem 1.2rem;
      text-decoration: none;
      transition: background 0.2s, color 0.2s;
      display: inline-block;
      font-size: 1rem;
    }
    .project a.button:hover {
      background: var(--secondary);
      color: #fff;
    }
    .tool-icons {
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      justify-content: center;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    .tool-icons div {
      flex: 1 1 120px;
      max-width: 140px;
      text-align: center;
    }
    .tool-icons img {
      width: 56px;
      height: 56px;
      margin-bottom: 0.7rem;
      filter: drop-shadow(0 2px 8px #00c6ff33);
      transition: transform 0.2s;
    }
    .tool-icons img:hover {
      transform: scale(1.18);
    }
    .kontakt-icons {
      display: flex;
      gap: 2rem;
      justify-content: center;
      align-items: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }
    .kontakt-icons a img {
      transition: transform 0.2s;
      border-radius: 8px;
      background: #222;
      padding: 6px;
      width: 40px;
      height: 40px;
    }
    .kontakt-icons a:hover img {
      transform: scale(1.2);
      background: var(--primary);
    }
    .spotify-song-link {
      font-weight: bold;
      color: var(--accent);
      text-decoration: none;
      transition: color 0.2s;
    }
    .spotify-song-link:hover {
      color: var(--primary);
      text-decoration: underline;
    }
    .goodreads-widget {
      margin-top: 1.5rem;
    }
    footer {
      text-align: center;
      padding: 2rem;
      background: #181c24;
      color: var(--muted);
      font-size: 1rem;
      border-top-left-radius: var(--radius);
      border-top-right-radius: var(--radius);
      margin-top: 3rem;
      box-shadow: 0 -2px 24px #0002;
    }
    @media (max-width: 700px) {
      main { padding: 0 0.5rem; }
      section { padding: 1.2rem 0.7rem; }
      .profile { flex-direction: column; gap: 1.2rem; }
      .profile img { width: 100px; height: 100px; }
      .tool-icons { gap: 1.2rem; }
      .kontakt-icons { gap: 1rem; }
      .project-list { grid-template-columns: 1fr; }
      nav {
        flex-direction: column;
        gap: 0.5rem;
        align-items: center;
        padding: 0.7rem 0;
      }
      nav a {
        font-size: 1rem;
        padding: 0.5rem 1.2rem;
        width: 90vw;
        text-align: center;
        margin: 0.2rem 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Adam Hornof</h1>
    <p>Student • Tvůrce • Geek</p>
  </header>
  <nav>
    <a href="#o-mne">O mně</a>
    <a href="#projekty">Projekty</a>
    <a href="#stack">Stack</a>
    <a href="#prave-ctu">Právě čtu</a>
    <a href="#kontakt">Kontakt</a>
  </nav>
  <main>
    <section id="o-mne">
      <h2>O mně</h2>
      <div class="profile">
        <img src="/me.png" alt="Adam Hornof">
        <div class="profile-info">
          <p>
            Jsem Adam Hornof – <span id="age"></span>letý student a tvůrce webů, který se nebojí zkoušet nové věci.<br>
            Věnuji se projektům, které mají smysl, od technické podpory neziskovek až po vlastní e-shopy.<br>
            Baví mě ecommerce, technologie a čistý webový design.
          </p>
        </div>
      </div>
      <h2 style="margin-top:2rem;">Právě poslouchám</h2>
      <div id="spotify-widget"></div>
    </section>
    <section id="projekty">
      <h2>Projekty</h2>
      <div style="margin-bottom:2rem;">
        <label for="project-tag-filter" style="font-weight:600;color:#00c6ff;margin-right:1rem;">Filtrovat podle štítku:</label>
        <select id="project-tag-filter" style="padding:0.5rem 1rem;border-radius:0.7rem;border:none;background:#23283a;color:#fff;font-size:1.1rem;">
          <option value="all">Vše</option>
          <option value="wordpress">WordPress</option>
          <option value="ecommerce">Ecommerce</option>
        </select>
      </div>
      <div class="project-list" id="project-list">
        <div class="project" data-tags="wordpress">
          <h3>QR Darovací Formulář</h3>
          <p>WordPress plugin pro neziskovky a projekty, které chtějí přijímat příspěvky pomocí QR platby. Umožňuje víc účtů, vlastní poznámky a je extrémně jednoduchý pro BFU.</p>
          <ul>
            <li>✅ Podpora více účtů a poznámek</li>
            <li>✅ Generuje QR kód přes Paylibo API</li>
            <li>✅ Proměnná <code>{{jmeno}}</code> v poznámce pro příjemce</li>
            <li>✅ Uživatelsky přívětivá administrace</li>
          </ul>
          <a class="button" href="https://github.com/adamhornofmedia/QR-Darovaci-Formular/tree/main">Zobrazit na GitHubu</a>
          <a class="button" href="https://stastny-usmev.cz/sponzorstvi-a-dary/">Plugin na webu Šťastný úsměv, z.s.</a>
        </div>
        <div class="project" data-tags="ecommerce">
          <h3>TechMerch.cz</h3>
          <p>E-shop s technologicky laděnými tričky.</p>
          <a class="button" href="https://techmerch.cz" target="_blank">Zobrazit</a>
        </div>
        <div class="project" data-tags="wordpress">
          <h3>Šťastný úsměv, z.s.</h3>
          <p>Pro neziskovou organizaci Šťastný úsměv, z.s. zajišťuji kompletní technickou správu – od běžné údržby webu na WordPressu až po podporu Google Workspace (e-maily, Drive, Kalendář). Pomáhám jim soustředit se na jejich činnost tím, že se starám o technické zázemí.</p>
          <ul>
            <li>✅ Nakladatelská činnost - řeším vydávání knih spolku</li>
            <li>✅ Správa WordPress webu (aktualizace, úpravy obsahu, zálohování)</li>
            <li>✅ Google Workspace – účty, DNS, e-mailová doména</li>
          </ul>
          <a class="button" href="https://stastny-usmev.cz/?adamhornof.cz" target="_blank">Zobrazit</a>
        </div>
        <div class="project" data-tags="wordpress">
          <h3>CovidPřehled.cz</h3>
          <p>Jednoduchý web, který během pandemie přehledně zobrazoval statistiky o COVID-19 v Česku. Nabízel upozornění na opatření přímo do telefonu a generátor čestného prohlášení pro přechod mezi okresy.</p>
          <ul>
            <li>✅ Sběr a aktualizace dat (MZČR a další otevřené zdroje)</li>
            <li>✅ Přehledné statistiky, upozornění a generátor pro uživatele</li>
            <li>✅ Responsivní design a jednoduché ovládání</li>
          </ul>
          <p>🗓️ Projekt běžel během let 2020–2022.</p>
        </div>
        <div class="project" data-tags="wordpress">
          <h3>XQE.cz – Technologický blog</h3>
          <p>Osobní blog o technologiích, digitální produktivitě a nástrojích.</p>
          <a class="button" href="https://xqe.cz/?adamhornof.cz" target="_blank">Zobrazit</a>
        </div>
      </div>
    </section>
    <section id="stack">
      <h2>Používám</h2>
      <div class="tool-icons">
        <div>
          <img src="/icons/wordpress.svg" alt="WordPress">
          <p>WordPress</p>
        </div>
        <div>
          <img src="/icons/woocommerce.svg" alt="WooCommerce">
          <p>WooCommerce</p>
        </div>
        <div>
          <img src="/icons/analytics.svg" alt="Google Analytics">
          <p>Google Analytics</p>
        </div>
        <div>
          <img src="/icons/workspace.svg" alt="Google Workspace">
          <p>Google Workspace</p>
        </div>
        <div>
          <img src="/icons/figma.svg" alt="Figma">
          <p>Figma</p>
        </div>
      </div>
    </section>
    <section id="prave-ctu">
      <h2>Právě čtu</h2>
      <div id="goodreads-widget" class="goodreads-widget">Načítám...</div>
    </section>
    <section id="kontakt">
      <h2>Kontakt</h2>
      <p>Rád si popovídám o spolupráci, nápadech i projektech. Ozvi se mi 👇</p>
      <div class="kontakt-icons">
        <a href="mailto:jsem@adamhornof.cz" title="Email" target="_blank" rel="noopener noreferrer">
          <img src="/icons/email.svg" alt="Email" />
        </a>
        <a href="https://www.linkedin.com/in/adamhornof/" title="LinkedIn" target="_blank" rel="noopener noreferrer">
          <img src="/icons/linkedin.svg" alt="LinkedIn" />
        </a>
        <a href="https://github.com/adamhornofmedia" title="GitHub" target="_blank" rel="noopener noreferrer">
          <img src="/icons/github.svg" alt="GitHub" />
        </a>
        <a href="https://www.printables.com/@adamhornof" title="Printables" target="_blank" rel="noopener noreferrer">
          <img src="/icons/printables-logo.svg" alt="Printables" />
        </a>
        <a href="https://kinobox.cz/uzivatele/209445" title="Kinobox" target="_blank" rel="noopener noreferrer">
          <img src="/icons/kinobox.svg" alt="Kinobox" />
        </a>
        <a href="https://www.goodreads.com/nejsemzpardubic" title="Goodreads" target="_blank" rel="noopener noreferrer">
          <img src="/icons/goodreads.svg" alt="Goodreads" />
        </a>
        <a href="https://m.me/adamhornof" title="Messenger" target="_blank" rel="noopener noreferrer">
          <img src="/icons/messenger.svg" alt="Messenger" />
        </a>
        <a href="https://discord.com/users/417027300023074864" title="Discord" target="_blank" rel="noopener noreferrer">
          <img src="/icons/discord.svg" alt="Discord" />
        </a>
      </div>
      <div style="margin-top: 1rem; text-align: center;">
        <a href="mailto:jsem@adamhornof.cz" style="color: #00c6ff; font-weight: 600;">jsem@adamhornof.cz</a>
      </div>
    </section>
  </main>
  <footer>
    &copy; <span id="currentYear"></span> Adam Hornof. Všechna práva vyhrazena.<br>
    IČO: 23294566<br>
    Sídlo: Nové sady 988/2, Brno, 602 00
  </footer>
  <script>
    document.getElementById('currentYear').textContent = new Date().getFullYear();

    // Věk podle data narození
    function calculateAge(birthDateString) {
      const today = new Date();
      const birthDate = new Date(birthDateString);
      let age = today.getFullYear() - birthDate.getFullYear();
      const m = today.getMonth() - birthDate.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }
      return age;
    }
    document.getElementById('age').textContent = calculateAge('2005-10-25');

    // Spotify widget
    let lastTrackId = null;
  let trackEndTimestamp = null;
  let lastSongData = null;
  let apiInterval = null;

  async function loadNowPlaying() {
    try {
      const res = await fetch("https://adamhornofmedia-github-io.vercel.app/api/spotify");
      const data = await res.json();

      const widget = document.getElementById("spotify-widget");
      if (!widget) return;

      if (!data || !data.item) {
        widget.innerHTML = `
          <div style="display:flex;align-items:center;gap:10px;justify-content:center;">
            <img src="/icons/spotify.svg" alt="Spotify" style="width:48px;height:48px;">
            <div style="color:#aaa; font-size:1.1em;">Právě nic neposlouchám</div>
          </div>
        `;
        lastTrackId = null;
        trackEndTimestamp = null;
        lastSongData = null;

        if (!apiInterval) {
          apiInterval = setInterval(loadNowPlaying, 60000);
        }
        return;
      }

      // Pokud něco hraje, zruš interval pro obnovu API
      if (apiInterval) {
        clearInterval(apiInterval);
        apiInterval = null;
      }

      const song = data.item.name;
      const artist = data.item.artists.map(a => a.name).join(", ");
      const img = data.item.album.images[0].url;
      const link = data.item.external_urls.spotify;
      const trackId = data.item.id;
      const progressMs = data.progress_ms;
      const durationMs = data.item.duration_ms;
      const isPlaying = data.is_playing; // <-- důležité!

      lastSongData = { song, artist, img, link, durationMs, progressMs, isPlaying };

      // Pokud je nová skladba, nastav trackEndTimestamp
      if (trackId !== lastTrackId) {
        lastTrackId = trackId;
        trackEndTimestamp = Date.now() + (durationMs - progressMs);
      }

      let remainingMs, playedMs, progressWidth;
      if (isPlaying) {
        remainingMs = trackEndTimestamp - Date.now();
        if (remainingMs < 0) remainingMs = 0;
        playedMs = durationMs - remainingMs;
      } else {
        playedMs = progressMs;
        remainingMs = durationMs - playedMs;
      }
      progressWidth = Math.round(playedMs / durationMs * 180);

      const min = Math.floor(remainingMs / 60000);
      const sec = String(Math.floor((remainingMs % 60000) / 1000)).padStart(2, '0');

      widget.innerHTML = `
        <div style="display:flex;align-items:center;gap:10px;">
          <img src="${img}" alt="Album cover" style="width:64px;height:64px;">
          <div>
            <a href="${link}" target="_blank" class="spotify-song-link">
              ${song}
            </a>
            <div>${artist}</div>
            <div style="margin-top:8px;">
              <div class="spotify-progress-bar" style="background:#222; border-radius:4px; height:8px; width:180px; position:relative;">
                <div class="spotify-progress" style="background:#00c6ff; height:8px; border-radius:4px; width:${progressWidth}px;"></div>
              </div>
              <div class="spotify-remaining" style="font-size:0.9em; color:#aaa; margin-top:2px;">
                Zbývá ${min}:${sec} min
              </div>
              ${!isPlaying ? '<div style="color:#00c6ff; font-size:0.9em; margin-top:2px;">Pozastaveno</div>' : ''}
            </div>
          </div>
        </div>
      `;
    } catch (e) {
      // Pokud fetch selže, zobraz logo a text
      const widget = document.getElementById("spotify-widget");
      if (widget) {
        widget.innerHTML = `
          <div style="display:flex;align-items:center;gap:10px;justify-content:center;">
            <img src="/icons/spotify.svg" alt="Spotify" style="width:48px;height:48px;">
            <div style="color:#aaa; font-size:1.1em;">Právě nic neposlouchám</div>
          </div>
        `;
      }
    }
  }

  // První načtení dat ze Spotify
  loadNowPlaying();

  // Každou sekundu dopočítáváme progress bar a čas, API voláme jen při nové písni nebo když nic nehraje
  setInterval(() => {
    const widget = document.getElementById("spotify-widget");
    if (lastTrackId && lastSongData && trackEndTimestamp) {
      let remainingMs, playedMs, progressWidth;
      if (lastSongData.isPlaying) {
        remainingMs = trackEndTimestamp - Date.now();
        if (remainingMs < 0) remainingMs = 0;
        playedMs = lastSongData.durationMs - remainingMs;
      } else {
        playedMs = lastSongData.progressMs;
        remainingMs = lastSongData.durationMs - playedMs;
      }
      progressWidth = Math.round(playedMs / lastSongData.durationMs * 180);

      const min = Math.floor(remainingMs / 60000);
      const sec = String(Math.floor((remainingMs % 60000) / 1000)).padStart(2, '0');

      const progressBar = widget.querySelector('.spotify-progress');
      if (progressBar) progressBar.style.width = `${progressWidth}px`;
      const timeDiv = widget.querySelector('.spotify-remaining');
      if (timeDiv) timeDiv.textContent = `Zbývá ${min}:${sec} min`;

      // Pozastaveno info
      const pausedDiv = widget.querySelector('.spotify-paused');
      if (pausedDiv) {
        pausedDiv.style.display = lastSongData.isPlaying ? 'none' : 'block';
      }

      // Pokud skladba doběhla, načti znovu z API
      if (remainingMs === 0) {
        loadNowPlaying();
      }
    }
  }, 1000);

  async function loadCurrentlyReading() {
    const url = "https://adamhornofmedia-github-io.vercel.app/api/goodreads"; // tvůj Vercel endpoint
    try {
      const res = await fetch(url);
      const xml = await res.text();

      // Parse XML
      const parser = new DOMParser();
      const doc = parser.parseFromString(xml, "application/xml");
      const items = Array.from(doc.querySelectorAll("item"));

      const widget = document.getElementById("goodreads-widget");
      if (items.length === 0) {
        widget.innerHTML = "Momentálně nečtu žádnou knihu.";
        return;
      }

      // Filtrovat knihy, které mají v <description> "read at:" prázdné
      const currentlyReading = items.filter(item => {
        const desc = item.querySelector("description")?.textContent || "";
        const readAtMatch = desc.match(/read at:\s*([^<\n\r]*)/i);
        return readAtMatch && readAtMatch[1].trim() === "";
      });

      if (currentlyReading.length === 0) {
        widget.innerHTML = "Momentálně nečtu žádnou knihu.";
        return;
      }

      widget.innerHTML = currentlyReading.map(item => {
        const desc = item.querySelector("description")?.textContent || "";

        // Odkaz na stránku knihy (vyparsuj z <a href="..."> v description)
        let bookUrl = "#";
        const bookUrlMatch = desc.match(/<a href="([^"]+)"[^>]*>/i);
        if (bookUrlMatch) bookUrl = bookUrlMatch[1];

        // Vyparsuj autora z description
        let author = "";
        const authorMatch = desc.match(/author:\s*([^<\n\r]+)/i);
        if (authorMatch) {
          author = authorMatch[1].trim();
        }

        // Obálka knihy
        let cover = "";
        const imgMatch = desc.match(/<img[^>]+src="([^"]+)"[^>]*>/i);
        if (imgMatch) cover = imgMatch[1];

        // Název knihy
        const title = item.querySelector("title")?.textContent || "";

        return `
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:1rem;">
            <img src="${cover}" alt="${title}" style="width:48px;height:70px;object-fit:cover;border-radius:6px;">
            <div>
              <a href="${bookUrl}" target="_blank" style="color:#00c6ff;font-weight:600;text-decoration:none;">${title}</a>
              <div style="color:#aaa;font-size:0.95em;">${author}</div>
            </div>
          </div>
        `;
      }).join('');
    } catch (e) {
      document.getElementById("goodreads-widget").innerHTML = "Nelze načíst knihy.";
    }
  }
  loadCurrentlyReading();

  // Filtr projektů podle štítků (jen aktuální tagy)
  const tagFilter = document.getElementById('project-tag-filter');
  const projectList = document.getElementById('project-list');
  const allProjects = Array.from(projectList.children);

  tagFilter.addEventListener('change', function() {
    const tag = this.value;
    allProjects.forEach(project => {
      if (tag === 'all' || project.dataset.tags.includes(tag)) {
        project.style.display = '';
      } else {
        project.style.display = 'none';
      }
    });
  });
  </script>
</body>
</html>
